<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Ship Sim</title>
	<style>
		body 
		{
			background-image: url("fondo.jpg");
			text-align: center;

		}
		canvas
		{
			text-align: center;
		}
	</style>
</head>

<body>
	<canvas id = "canvas" width = "1000" height = "1000"></canvas>
	<script src="utils.js"></script>
	<script src="ship.js"></script>
	<script>
		window.onload = function ()
		{
			var canvas = document.getElementById('canvas'),
          context = canvas.getContext('2d'),
          ship = new Navecita(),
          vr = 0,
          vx = 0,
          vy = 0,
          thrust = 0,
		  friction = 0.97;
			
		   ship.x = canvas.width / 2;
      	   ship.y = canvas.height / 2;

      	window.addEventListener('keydown', function (event) 
		{
			switch (event.keyCode) 
			{
				case 37:      //left
					vr = -3;
					break;
        	case 39:      //right
					vr = 3;
					break;
			case 38:      //up
					thrust = 0.05;
					ship.showFlame = true;
					break;
			}
      }, false);

      window.addEventListener('keyup', function () 
		{
		  vr = 0;
		  thrust = 0;
		  ship.showFlame = false;
	  	}, false);
		
		(function drawFrame () 
		 {
			window.requestAnimationFrame(drawFrame, canvas);
			context.clearRect(0, 0, canvas.width, canvas.height);

        	ship.rotation += vr * Math.PI / 180;
        	var angle = ship.rotation, //in radians
            	ax = Math.cos(angle) * thrust,
				ay = Math.sin(angle) * thrust,
				left = 0,
				right = canvas.width,
				top = 0,
				bounce = -0.7,
				bottom = canvas.height;
				
			vx += ax;
			vy += ay;
			vx *= friction;
			vy *= friction;
			ship.x += vx;
			ship.y += vy;
			
			if (ship.x + ship.radius > right)
				{
					ship.x = right - ship.radius;
					vx *= bounce; 
				}
				else if (ship.x - ship.radius < left)
					{
						ship.x = left + ship.radius;
						vx *= bounce; 
					}
			
			if (ship.y + ship.radius > bottom)
				{
					ship.y = bottom - ship.radius;
					vy *= bounce; 
				}
				else if (ship.y - ship.radius < top)
					{
						ship.y = top + ship.radius;
						vy *= bounce; 
					}
			
			ship.draw(context);
		}());
    };
	</script>
</body>
</html>
